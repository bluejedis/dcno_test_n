<div style="float: left; width: 64%; padding: 1%;">



## TCP协议的特点  

<ul>

### TCP协议的主要特点

<ul>

- TCP是在不可靠的IP层之上实现的可靠的数据传输协议，它主要解决传输的可靠、有序、无丢失和不重复问题。TCP是TCP/IP体系中非常复杂的一个协议，主要特点如下：

</ul>

#### 连接特点

<ul>

- TCP是面向连接的传输层协议，TCP连接是一条逻辑连接
- 每一条TCP连接只能有两个端点，每一条TCP连接只能是一对一的

</ul>

#### 可靠性

<ul>

- TCP提供可靠交付的服务，保证传送的数据无差错、不丢失、不重复且有序

</ul>

#### 通信方式

<ul>

- TCP提供**全双工**通信，允许通信双方的应用进程在任何时候都能发送数据
  - TCP连接的两端都设有发送缓存和接收缓存，用来临时存放双向通信的数据
    - 发送缓存用来暂时存放以下数据：
      - $\textcircled{\scriptsize{1}}$ 发送应用程序传送给发送方TCP准备发送的数据
      - $\circledcirc$ TCP已发送但尚未收到确认的数据
    - 接收缓存用来暂时存放以下数据：
      - $\textcircled{\scriptsize{1}}$ 按序到达但尚未被接收应用程序读取的数据
      - $\circledcirc$ 不按序到达的数据

</ul>

#### 数据传输特点

<ul>

- TCP是面向字节流的，虽然应用程序和TCP的交互是一次一个数据块（大小不等）
- 但TCP把应用程序交下来的数据仅视为一连串的无结构的字节流

</ul>

#### 报文长度控制

<ul>

- TCP和UDP在发送报文时所采用的方式完全不同
  - UDP报文的长度由发送应用进程决定
  - TCP报文的长度则根据接收方给出的窗口值和当前网络拥塞程度来决定
    - 若应用进程传送到TCP缓存的数据块太长，则TCP就把它划分得短一些再传送
    - 若太短，则TCP也可等到积累足够多的字节后再构成报文段发送出去
- 关于TCP报文的长度问题，后面会详细讨论

</ul>

</ul>

</ul>

## TCP报文段

<ul>

### TCP报文段的结构

<ul>

- TCP传送的数据单元称为报文段
- TCP报文段既可以用来运载数据，又可以用来建立连接、释放连接和应答
- 一个TCP报文段分为首部和数据两部分
  - 整个TCP报文段作为IP数据报的数据部分封装在IP数据报中，如图5.6所示
  - 其首部的前20B是固定的
  - TCP首部最短为20B，后面有 $\bf{4N}$ 字节是根据需要而增加的选项
    - 长度为4B的整数倍

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/4f25e5e7af600a926e06cfbeecdb4d247bc24f97f4e1b6d8267cb4459a094260.jpg)  
图5.6TCP报文段  

</ul>

### TCP <span style="color: blue;">首部</span>字段

<ul>

> pro：TCP报文段首部中各字段的分析（2012）

#### 端口字段

<ul>

- 源端口和目的端口
  - 各占2B
  - 分别表示发送方和接收方使用的端口号

</ul>

> pro：TCP首部中序号、确认号的含义（2009、2016）

#### 序号和确认号字段

<ul>

- 序号
  - 占4B，范围为 $0{\sim}2^{32}\!-\!1$ ，共 $2^{32}$ 个序号
  - TCP连接中传送的字节流中的每个字节都要按顺序编号
  - 序号字段值指的是本报文段所发送的数据的第一个字节的序号
- 确认号
  - 占4B
  - 是期望收到对方下一个报文段的第一个数据字节的序号
  - 若确认号为 $N,$ 则表明到序号 $N\!-\!1$ 为止的所有数据都已正确收到

</ul>

> pro：TCP首部的最小长度（2021)

#### 控制字段

<ul>

- 数据偏移
  - 占4位
  - 表示首部长度
  - "数据偏移"的单位是32位
  - TCP首部的最大长度为 $60\mathrm{B}$
- 保留
  - 占6位
  - 保留为今后使用，目前应置为0
- 控制位
  - <span style="color: purple;">URG</span>（紧急位）
  - <b><span style="color: green;">ACK</span></b>（确认位）
  - PSH（推送位）
  - RST（复位位）
  - <span style="color: orange;">SYN</span>（同步位）
  - **FIN**（终止位）

</ul>

#### 其他字段

<ul>

- 窗口
  - 占2B，范围为 $0{\sim}2^{16}\mathrm{-}1$
  - 窗口值告诉对方允许发送的数据量
- 检验和
  - 占2B
  - 检验范围包括首部和数据两部分
- 紧急指针
  - 占2B
  - 仅在 $\mathrm{{URG}}\!=\!1$ 时才有意义
- 选项
  - 长度可变，最长可达 $40\mathrm{B}$
  - TCP最初只规定了MSS选项
- 填充
  - 使整个首部长度是4B的整数倍

</ul>

</ul>

</ul>


</div>
<div style="float: right; width: 26%; padding: 1%;">

</div>
<div style="clear: both;"></div>
