<div style="float: left; width: 64%; padding: 1%;">

### 开放最短路径优先Open shortest path first（OSPF）协议

<ul>

#### OSPF协议的基本特点

<ul>

- OSPF与RIP相比有以下4点主要区别：
  - OSPF向本自治系统中所有路由器发送信息。这里使用的方法是洪泛法。而RIP仅仅向自己相邻的几个路由器发送信息。
  - 发送的信息是与本路由器相邻的所有路由器的链路状态，但这只是路由器所知道的部分信息。而在RIP中，发送的信息是本路由器所知道的全部信息，即整个路由表。
  - 只有当链路状态发生变化时，路由器才用洪泛法向所有路由器发送此信息，并且更新过程收敛得快，不会出现RIP"坏消息传得慢"的问题。而在RIP中，不管网络拓扑是否发生变化，路由器之间都要定期交换路由表的信息。

> **pro：封装OSPF报文所采用的协议（2017）**

- OSPF是网络层协议，它不用UDP或TCP，而直接用IP数据报传送（其IP数据报首部的协议字段为89）。而RIP是应用层协议，它在传输层使用UDP。

> **attention:**

- 用UDP传送是指将该信息作为UDP报文的数据部分，而直接使用IP数据报传送是指将该信息直接作为IP数据报的数据部分。RIP报文是作为UDP数据报的数据部分。

##### OSPF的其他特点

<ul>

- OSPF充许对每条路由设置成不同的代价，对于不同类型的业务可计算出不同的路由。
- 若到同一个目的网络有多条相同代价的路径，则可将通信量分配给这几条路径。
- OSPF分组具有鉴别功能，从而保证仅在可信赖的路由器之间交换链路状态信息。
- OSPF支持可变长度的子网划分和无分类编址CIDR。
- 每个链路状态都带上一个32位的序号，序号越大，状态就越新。

</ul>

</ul>

#### OSPF的基本工作原理

<ul>

- 基本流程：
  - 各路由器之间频繁地交换链路状态信息
  - 所有路由器最终都能建立一个链路状态数据库，即全网的拓扑结构图
  - 每个路由器利用链路状态数据库中的数据，使用Dijkstra算法计算自己到达各自的网络的最优路径，构造出自己的路由表
  - 当链路状态发生变化时，每个路由器重新计算到达各目的网络的最优路径，构造出新的路由表

> **attention:**

- 虽然使用Dijkstra算法能计算出完整的最优路径，但路由表中不会存储完整路径，而只存储"下一跳"（只有到了下一跳路由器，才能知道再下一跳应当怎样走）。

##### OSPF的区域划分

<ul>

- 为了使OSPF能够用于规模很大的网络，OSPF将一个自治系统再划分为若干更小的范围，称为区域
- 划分区域的好处是，将利用洪泛法交换链路状态信息的范围局限在每个区域而非整个自治系统，从而减少了整个网络上的通信量

</ul>

</ul>

#### OSPF的五种分组类型

<ul>

- 问候分组：用来发现和维持邻站的可达性
- 数据库描述分组：向邻站给出自己的链路状态数据库中的所有链路状态项目的摘要信息
- 链路状态请求分组：尚对方请求发送某些链路状态项目的详细信息
- 链路状态更新分组：用洪泛法对全网更新链路状态，它是OSPF最核心的部分
- 链路状态确认分组：对链路更新分组的确认

##### OSPF分组的传送机制

<ul>

- 问候分组的传送：
  - 在网络中通常传送的OSPF分组大多是问候分组
  - 两个相邻路由器通常每隔10秒要交换一次问候分组，以便知道哪些站可达
  - 若有40秒没有收到某个相邻路由器发来的问候分组，则认为该相邻路由器不可达，应立即修改链路状态数据库，并重新计算路由表

</ul>

##### OSPF的初始化过程

<ul>

- 路由器刚开始工作时：
  - OSPF让每个路由器使用数据库描述分组和相邻路由器交换本数据库中已有的链路状态摘要信息
  - 然后，路由器使用链路状态请求分组，向对方请求发送自己所缺少的某些链路状态项目的详细信息
  - 经过一系列的这种分组交换，就建立了全网同步的链路数据库

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/f0865e7a3e56305b7752f9c75c0c571d220f187b9e36b71961fb01a56f2fc570.jpg)
图4.17OSPF的基本操作

</ul>

##### OSPF的运行维护

<ul>

- 链路状态更新：
  - 只要一个路由器的链路状态发生变化，该路由器就要使用链路状态更新分组，用洪泛法向全网更新链路状态
  - 其他路由器在收到更新分组后要发送确认
- 数据库刷新：
  - 为了确保链路状态数据库与全网的状态保持一致，OSPF还规定每隔一段时间（如30分钟）要刷新一次数据库中的链路状态
  - 因为一个路由器的链路状态只涉及与相邻路由器的连通状态，与整个网络的规模并无直接关系，thus 当互联网规模很大时，OSPF要比RIP好得多

</ul>

</ul>

</ul>


</div>
<div style="float: right; width: 26%; padding: 1%;">

</div>
<div style="clear: both;"></div>
