<div style="float: left; width: 64%; padding: 1%;">

好的，同学们，第三章《数据链路层》来了！这一章是计网的**“腰”，承上启下，内容超多，考点超硬**，是每年考研分差拉开的关键。无论是选择题还是计算大题，这里都是主战场。

别怕，跟紧我，我们用最形象的比喻和最精炼的模板，把这块硬骨头啃下来！

---

### **第3章 数据链路层**

**本章定位**：如果说物理层是修路（提供比特流传输），那数据链路层就是**“同城快递”**，负责把包裹（**帧**）在**相邻的两个站点**之间（比如你家小区门口到下一个中转站）进行可靠、高效的交付。

### **3.1 数据链路层的功能**

* **核心考点**:
    * 三大基本问题：`封装成帧`、`透明传输`、`差错检测`。
    * 两个信道类型：点对点、广播。
* **形象记忆**:
    * **封装成帧**: 给你的快递（网络层数据包）打上一个标准的快递包装盒，贴上“快递单”（**帧头**）和“封条”（**帧尾**）。
    * **透明传输**: 你的快递内容物里恰好有一张“快递单”，不能让快递员误以为是真正的快递单。所以要对它做特殊处理（比如装进一个透明袋子），这就是“透明传输”。
    * **差错检测**: 检查快递在运输途中有没有破损。
    * **流量控制**: 控制发快递的速度，别把快递中转站（接收方）给撑爆了。

### **3.2 组帧**

* **核心考点**:
    * 四种组帧方法的原理，特别是**字节填充**和**零比特填充**。
* **形象记忆 (如何识别快递包裹的边界)**:
    1.  **字符计数法**: 快递单上写明“本包裹共X公斤”。**缺点**: 如果‘X’这个数字在运输中磨损错了，后面所有包裹的识别就全乱了。
    2.  **字节填充法 (字符填充)**: 用特殊的“开始胶带”(SOH)和“结束胶带”(EOT)来封装。如果你的货物里恰好有“开始胶带”，就在它前面再贴一张“透明胶带”(ESC)，告诉快递员这不是边界。
        * **记忆口诀**: “**特殊字符**前，加**转义符**”。
    3.  **零比特填充法 (HDLC/PPP常用)**: 用一串特殊的比特串`01111110`作为包裹的边界。
        * **规则**: 发送时，数据中每遇到 **5个连续的1**，就**强制插入一个0**。
        * **接收时**: 每收到 **5个连续的1**，就检查后面是不是0，是就**删掉**，不是（是1）就说明是边界。
        * **记忆口诀**: "**五幺插零，五幺去零**"。
    4.  **违规编码法**: 利用物理层编码中不会出现的编码（比如曼彻斯特编码中的“高-高”电平）来标记边界。

### **3.3 差错控制**

* **核心考点**:
    * 检错编码 vs 纠错编码。
    * CRC循环冗余码的计算。**【计算大题高发区】**
    * 海明码的计算原理。
* **形象记忆**:
    * **检错编码 (CRC)**: 只能发现快递**破损**了，于是直接**扔掉**，通知发件人重发。
    * **纠错编码 (海明码)**: 不仅发现快递破损了，还能**修复**它（比如破了个小洞能补上）。

* **【计算题模板】: CRC循环冗余码计算**
    > **问题**: 待传数据为 `M`，生成多项式为 `G(x)`，求应发送的数据。

    1.  **确定`r`**: 看`G(x)`的最高次幂，`r`就是这个数。比如 $G(x) = x^4 + x + 1$，则 $r=4$。
    2.  **补零**: 在数据`M`后面补`r`个`0`。
    3.  **模2除法**: 用`G(x)`对应的二进制码，去除补零后的数据。
        * **核心**: **异或(XOR)运算**，相同为0，不同为1。**不借位！**
        * **技巧**: 商几不重要，关键是余数。当被除数首位是1，商1；首位是0，商0。
    4.  **得出余数(FCS)**: 余数不足`r`位时，**前面补0**，凑够`r`位。
    5.  **拼接发送**: 最终发送的数据 = 原始数据`M` + `r`位的余数(FCS)。
    * **检验**: 接收方用收到的完整数据除以`G(x)`，若余数为0，则认为无差错。

### **3.4 流量控制与可靠传输机制**

这是 **【本章的绝对核心，每年必考，计算、概念都是重点】**。

* **核心考点**:
    * 停止-等待协议 (SW)。
    * 后退N帧协议 (GBN)。
    * 选择重传协议 (SR)。
    * 三种协议的窗口大小、确认方式、重传策略对比。
    * 信道利用率计算。

* **形象记忆 (发送一部10集的电视剧)**:
    * **停止-等待 (SW)**: 发送方是“憨憨”，接收方也是“憨憨”。
        * **流程**: 发第1集 -> 等接收方回“第1集收到” -> 再发第2集...
        * **窗口**: 发送窗口 $W_T=1$，接收窗口 $W_R=1$。
        * **效率**: 极低，大部分时间都在等待。
    * **后退N帧 (GBN)**: 发送方是“急性子”，接收方是“死心眼”。
        * **流程**: 一口气发1、2、3、4、5集。如果第3集丢了，接收方收到4、5集时会发现不是按顺序的，**直接丢弃**4、5集。并反复告诉发送方“我要第3集”。发送方超时后，**从第3集开始重传** 3、4、5...
        * **窗口**: $W_T > 1$, $W_R = 1$ (死心眼，只认按序的)。
        * **确认**: **累积确认** (收到ACKn表示n号及之前都收到了)。
    * **选择重传 (SR)**: 发送方是“急性子”，接收方是“小机灵”。
        * **流程**: 一口气发1、2、3、4、5集。如果第3集丢了，接收方收到4、5集，会**缓存**起来，并告诉发送方“第3集没收到”。发送方超时后，**只重传第3集**。等第3集到了，接收方再把2、3、4、5一起交给上层。
        * **窗口**: $W_T > 1$, $W_R > 1$ (小机灵，能缓存乱序的)。
        * **确认**: **逐一确认**。

* **【计算题模板】: 信道利用率 / 极限速率**
    > **问题**: 给定发送窗口大小 `W`，数据帧发送时延 $T_D$，往返时延 $RTT$，求信道利用率 $U$。

    1.  **理解周期**: 一个发送周期是指从“开始发送第一个数据帧”到“收到它的确认帧”为止，这段时间内发送方能做多少事。
    2.  **计算流水线能发送多少个帧**: 在一个 $RTT$ 内，可以发送的帧数量为 $N = \frac{T_D + RTT}{T_D}$。
    3.  **分情况讨论**:
        * **Case 1: `W < N`** (窗口太小，没填满流水线)
            * 发送方发完 `W` 个帧就得停下等待。
            * **公式**: $U = \frac{W \times T_D}{T_D + RTT}$
        * **Case 2: `W >= N`** (窗口足够大，填满了流水线)
            * 发送方可以一直不停地发送。
            * **公式**: $U = 1$ (或 100%)
    4.  **计算极限速率**: 极限数据传输速率 = $U \times$ 信道带宽。

### **3.5 介质访问控制 (MAC)**

* **核心考点**:
    * 静态划分 (信道划分)：FDM, TDM, WDM, **CDM (码分复用)**。
    * 动态分配 (随机访问)：CSMA/CD (有线局域网核心)，CSMA/CA (无线局域网核心)。

* **形象记忆 (教室里学生抢答问题)**:
    * **信道划分 (静态)**:
        * **TDM (时分)**: 老师规定，小明第1分钟发言，小红第2分钟... **轮流发言**。
        * **FDM (频分)**: 老师给每人发一个不同频率的麦克风，大家可以**同时说话互不干扰**。
        * **CDM (码分)**: 大家用不同的“方言”（码片序列）同时说话，老师有特殊的“助听器”（解码），可以只听懂某个人的方言。**【计算考点】**: 分离信号就是用自己的码片序列去和混合信号做**内积**。
    * **随机访问 (动态)**:
        * **ALOHA**: **想说就说**，说错了（冲突）就等会儿再说。
        * **CSMA**: **先听后说** (先听听有没有人在说)。
        * **CSMA/CD (带冲突检测)**: **边说边听**。
            * **流程**: 先听(没人说) -> 开始说 -> **一直听着** -> 如果听到别人也在说(冲突！) -> **立刻闭嘴** -> 随机等一会儿 -> 再重复。
            * **【计算考点】最小帧长**: 为了确保在A把话说完之前，能听到最远的B的冲突声音。公式: `最小帧长(bit) = 2 × 最大传播时延(s) × 数据率(b/s)`。
        * **CSMA/CA (带冲突避免)**: 用在Wi-Fi。
            * **原因**: 无线环境“听”不准（有隐藏站问题）。
            * **流程**: 我想说 -> 先广播一个“**我要开说了！(RTS)**” -> AP回复一个“**大家都安静，让他说！(CTS)**” -> 我再说。这是**预约信道**。

### **3.6 局域网 (LAN)**

* **核心考点**:
    * 以太网 (IEEE 802.3)，MAC地址 (48位)，MAC帧格式。
    * 无线局域网 (IEEE 802.11)，其帧的三个地址字段的含义。
* **形象记忆**:
    * **MAC地址**: 设备的**身份证号**，全球唯一，固化在网卡上。
    * **以太网V2帧格式**:
        * `[目的MAC(6B)] [源MAC(6B)] [类型(2B)] [数据(46-1500B)] [FCS(4B)]`
        * **记忆**: “**收件人-发件人-物品类型-物品-封条**”
    * **802.11帧的三个地址**: (AP: Access Point, 无线路由器)
        * **场景**: 你(A)通过AP想访问服务器(B)。
        * A发给AP的帧: `Addr1(AP)`, `Addr2(A)`, `Addr3(B)` (接收者是AP，发送者是你，最终目的地是B)。
        * AP发给B的帧: 这是有线以太网帧了。
        * **记忆**: **Addr1**是直接接收者，**Addr2**是直接发送者，**Addr3**是最终/原始目标。

### **3.7 广域网 (WAN)**

* **核心考点**: PPP协议的特点和帧格式。
* **形象记忆**:
    * **PPP协议**: 你家电脑拨号上网时和ISP之间建立的“专用通道”协议。
    * **特点**:
        * 简单，不需要编号和确认（不可靠）。
        * 面向字节，支持多种网络层协议。
        * 是**点对点**的，所以不需要MAC地址。

### **3.8 数据链路层设备**

* **核心考点**: **以太网交换机 (二层交换机)** 的工作原理。**【高频考点】**
* **形象记忆**:
    * **网桥/交换机**: 一个聪明的“**楼层管理员**”。
        * **工作原理(自学习)**:
            1.  刚上班时，不知道每个房间（端口）里是谁（MAC地址）。
            2.  当A房间的人(MAC_A)从1号门出去送信时，管理员就在本本上记下：“**MAC_A 在 1号门**”。
            3.  当有信要送给B时，先查本本。
                * 如果本本上有记录（B在3号门），就直接从3号门送进去 (**转发**)。
                * 如果本本上没记录，就从**除了信源（1号门）外的所有门**喊一嗓子（**广播/泛洪**）。
            4.  如果信是送给A的，管理员一看A就在1号门，信也是从1号门进来的，就把信**丢弃**（**过滤**），不转发了。
        * **隔离域**:
            * 交换机的每个端口都是一个独立的**冲突域** (每个房间里的人可以自由说话)。
            * 但整个交换机连接的所有设备仍在一个**广播域**里 (管理员喊一嗓子，所有房间都能听到)。

---

第三章内容虽多，但核心就是 **可靠传输协议(SW, GBN, SR)** 和 **MAC访问控制协议(CSMA/CD, CSMA/CA)**。把这两个大块头拿下，再辅以帧格式、设备原理，这一章的分数就稳了！多画图，多做计算题！
</div>
<div style="float: right; width: 26%; padding: 1%;">

</div>
<div style="clear: both;"></div>
