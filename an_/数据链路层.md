<div style="float: left; width: 64%; padding: 1%;">

好的，同学们，第三章《数据链路层》来了！这一章是计网的**“腰”，承上启下，内容超多，考点超硬**，是每年考研分差拉开的关键。无论是选择题还是计算大题，这里都是主战场。

别怕，跟紧我，我们用最形象的比喻和最精炼的模板，把这块硬骨头啃下来！

---

### **第3章 数据链路层**

**本章定位**：如果说物理层是修路（提供比特流传输），那数据链路层就是**“同城快递”**，负责把包裹（**帧**）在**相邻的两个站点**之间（比如你家小区门口到下一个中转站）进行可靠、高效的交付。

### **3.1 数据链路层的功能**

#### **3.1.1 数据链路层所处的地位**

* **核心考点**: 理解数据链路层是**点到点**（或称节点到节点）的通信。
* **形象记忆**:
    * 网络层规划了从北京到上海的**全程路线**。
    * 数据链路层只负责其中**一小段**，比如从“北京中转站”开车到“天津中转站”。它不关心货物的最终目的地是上海。

#### **3.1.2 为网络层提供服务**

* **核心考点**: 三种服务类型，其中“无确认的无连接服务”最常用（如以太网）。
* **形象记忆**:
    * **无确认无连接**: 普通平信，投递后不管收没收到。
    * **有确认无连接**: 挂号信，投递后需要对方签收。
    * **有确认面向连接**: 高保价快递，先打电话确认地址，再派送，每一步都要签收。

#### **3.1.3 链路管理**

* **核心考点**: 主要用于“有确认面向连接服务”，涉及连接的建立、维持、释放。
* **形象记忆**: 就像打电话，需要先`拨号`、`通话`、`挂机`。

#### **3.1.4 封装成帧与透明传输**

* **核心考点**: 帧定界，透明传输的含义与实现。
* **形象记忆**:
    * **封装成帧**: 给你的快递（网络层数据包）打上一个标准的快递包装盒，贴上“快递单”（**帧头**）和“封条”（**帧尾**）。有了包装盒，接收方才知道一个包裹从哪开始，到哪结束。
    * **透明传输**: 如果你的快递内容物里恰好也有一张“快递单”，不能让快递员误以为是真正的快递单。所以要对它做特殊处理（比如用“转义字符”包装一下），这就是“透明传输”。

#### **3.1.5 流量控制**

* **核心考点**: 限制发送方速率，防止“淹没”接收方。
* **形象记忆**: 你说话太快，我听不过来了，就对你说：“慢点，慢点！”。这是**点对点**的速度协调。

#### **3.1.6 差错检测**

* **核心考点**: 能够发现数据在传输中产生的比特差错（位错）。
* **形象记忆**: 检查快递包裹在运输途中有没有破损。如果破了，就直接扔掉。

---

### **3.2 组帧**

#### **3.2.1 字符计数法**

* **核心考点**: 在帧头部用一个字段记录帧的字节数。
* **形象记忆**: 快递单上写明“本包裹共X公斤”。
* **致命缺点**: 如果‘X’这个数字在运输中磨损错了，后面所有包裹的识别就全乱套了。

#### **3.2.2 字节填充法**

* **核心考点**: 使用特定字符（如`SOH`, `EOT`）定界，并用转义字符（`ESC`）解决数据与定界符冲突的问题。
* **记忆模板**:
    * **规则**: 在数据中出现的每一个`SOH`, `EOT`, `ESC`前，都**插入一个`ESC`**。
    * **接收方**: 收到连续两个`ESC`，就删掉第一个；收到`ESC`后跟一个`SOH`或`EOT`，就删掉`ESC`。

#### **3.2.3 零比特填充法**

* **核心考点**: HDLC、PPP等协议使用。用比特串`01111110`作为帧定界符。
* **记忆模板**:
    * **规则**: 发送时，数据中每遇到 **5个连续的1**，就**强制插入一个0**。
    * **接收时**: 每收到 **5个连续的1**，就检查并**删除**后面紧跟的那个0。
    * **口诀**: "**五幺插零，见五幺去零**"。

#### **3.2.4 违规编码法**

* **核心考点**: 利用物理层编码中不会出现的编码来标记帧的边界。
* **形象记忆**: 正常说话用高低音（高低电平），用一个既不高也不低的“怪音”（违规电平）来表示一句话的开始和结束。

---

### **3.3 差错控制**

#### **3.3.1 检错编码**

* **核心考点**: CRC循环冗余码的计算。**【计算大题高发区】**
* **形象记忆 (CRC)**:
    * 双方约定一个“**除数**”（生成多项式）。
    * 发送方用“**原始数据**”除以“**除数**”，把得到的“**余数**”（FCS）附在数据后面一起发送。
    * 接收方用收到的“**带余数的数据**”再除以那个“**除数**”，如果余数为0，就认为数据没问题。

* **【计算题模板】: CRC循环冗余码计算**
    1.  **确定`r`**: 看生成多项式`G(x)`的最高次幂，`r`就是这个数。
    2.  **补零**: 在数据`M`后面补`r`个`0`。
    3.  **模2除法**: 用`G(x)`对应的二进制码，去除补零后的数据。
        * **核心**: **异或(XOR)运算**，相同为0，不同为1。**不借位！**
    4.  **得出余数(FCS)**: 余数必须是`r`位，不足则**前面补0**。
    5.  **拼接发送**: 最终发送的数据 = `原始数据M` + `r位的余数(FCS)`。

#### **3.3.2 纠错编码**

* **核心考点**: 海明码的原理和计算。
* **形象记忆 (海明码)**:
    * 不仅能发现快递**破损**了，还能**修复**它（比如破了个小洞能补上）。通过巧妙地设置多个奇偶校验位，它们的组合结果能直接定位到出错的那一位。
* **【计算题模板】: 海明码计算**
    1.  **定校验位数 k**: 满足 $2^k \ge m+k+1$ (m为数据位数)。
    2.  **定校验位位置**: 校验位 $P_i$ 放在海明码的第 $2^{i-1}$ 位上（第1, 2, 4, 8...位）。
    3.  **分组**:
        * $P_1$ 校验所有位号的二进制末位是1的位（H1, H3, H5, H7...）。
        * $P_2$ 校验所有位号的二进制倒数第二位是1的位（H2, H3, H6, H7...）。
        * $P_3$ 校验所有位号的二进制倒数第三位是1的位（H4, H5, H6, H7...）。
    4.  **求校验位的值**: 每个校验位的值，是其所在组内所有**数据位**的**异或**结果（以偶校验为例）。
    5.  **纠错**: 接收方对每个组进行异或校验，得到纠错码S3S2S1，其**十进制值就是出错位的位号**。若为0，则无错。

---

### **3.4 流量控制与可靠传输机制**

这是 **【本章的绝对核心，每年必考，计算、概念都是重点】**。

#### **3.4.1 流量控制与滑动窗口机制**

* **核心考点**: 滑动窗口是实现流量控制和可靠传输的基础。
* **形象记忆**:
    * **发送窗口**: 发送方手里拿着的一叠待发的信件，可以不等待回执就连续发出。
    * **接收窗口**: 接收方邮箱的容量，表示还能接收多少封信。
    * **窗口滑动**: 发送方收到一封信的回执，就可以再多发一封新的；接收方收到一封信并处理完，邮箱就空出一个位置。

#### **3.4.2 可靠传输机制**

* **核心考点**: 三种协议的窗口大小、确认方式、重传策略对比。
* **形象记忆 (发送一部10集的电视剧)**:
    * **停止-等待 (SW)**: 发送方是“憨憨”，接收方也是“憨憨”。
        * **流程**: 发第1集 -> 等接收方回“第1集收到” -> 再发第2集...
        * **窗口**: 发送窗口 $W_T=1$，接收窗口 $W_R=1$。
    * **后退N帧 (GBN)**: 发送方是“急性子”，接收方是“死心眼”。
        * **流程**: 一口气发1、2、3、4、5集。如果第3集丢了，接收方收到4、5集会**直接丢弃**。发送方超时后，**从第3集开始重传** 3、4、5...
        * **窗口**: $W_T > 1$, $W_R = 1$ (死心眼，只认按序的)。
        * **确认**: **累积确认** (收到ACKn表示n号及之前都收到了)。
    * **选择重传 (SR)**: 发送方是“急性子”，接收方是“小机灵”。
        * **流程**: 一口气发1、2、3、4、5集。如果第3集丢了，接收方会**缓存**4、5集。发送方超时后，**只重传第3集**。
        * **窗口**: $W_T > 1$, $W_R > 1$ (小机灵，能缓存乱序的)。
        * **确认**: **逐一确认**。

* **【计算题模板】: 信道利用率**
    > **问题**: 给定发送窗口大小 `W`，数据帧发送时延 $T_D$，往返时延 $RTT$，求信道利用率 $U$。

    1.  **理解周期**: 一个发送周期是指从“开始发送第一个数据帧”到“收到它的确认帧”为止，总时长为 $T_{cycle} = T_D + RTT (+T_A)$。
    2.  **理解发送量**: 在这一个周期内，发送方最多可以发送 `W` 个数据帧，总的发送时间为 $W \times T_D$。
    3.  **计算利用率**:
        * **公式**: $U = \frac{W \times T_D}{T_D + RTT}$ (若确认帧很小，$T_A$可忽略)
        * **临界条件**: 如果 $W \times T_D \ge T_D + RTT$，说明发送方可以一直不停地发送，信道被完全占满，此时利用率为 $U = 1$。

---

### **3.5 介质访问控制**

* **核心考点**: 解决在共享信道上“谁先说，谁后说”的问题。
#### **3.5.1 信道划分介质访问控制**
* **核心考点**: 静态划分信道，不会冲突。`FDM`, `TDM`, `WDM`, `CDM`。
* **形象记忆 (开会)**:
    * **TDM (时分)**: 轮流发言，小明第1分钟说，小红第2分钟说。
    * **FDM (频分)**: 每人发一个不同频率的麦克风，可以同时说。
    * **CDM (码分)**: 每人用不同的“方言”（码片序列）同时说，接收者有特殊的“助听器”，可以只听懂某个人的方言。

#### **3.5.2 随机访问介质访问控制**
* **核心考点**: 争用信道，可能会冲突。`CSMA/CD`（有线）和 `CSMA/CA`（无线）是绝对重点。
* **形象记忆 (文明地抢话)**:
    * **CSMA/CD (带冲突检测)** - **用于有线以太网**:
        * **规则**: `先听后说，边说边听，冲突停发，随机等待`。
        * **记忆**: 在一个很安静的房间里讨论，想说话前先听一下，开始说之后也竖着耳朵听，如果听到别人也在说（冲突），两人立刻都闭嘴，各自等一个随机时间再尝试。
        * **【计算题模板】最小帧长**: 为了确保在A把一句话说完之前，能听到最远的B的冲突声音。
            * **公式**: `最小帧长(bit) = 争用期(s) × 数据率(b/s)`，其中`争用期 = 2 × 最大传播时延`。
    * **CSMA/CA (带冲突避免)** - **用于无线局域网**:
        * **原因**: 无线环境“听”不准（有隐藏站问题），不能有效检测冲突。
        * **规则**: `发送前预约`。
        * **记忆**: 在一个嘈杂的广场上，你想发表长篇大论，你先举手大喊一声：“**大家安静，我要说话了！(RTS)**”。主持人（AP）听到了，就对全场说：“**都别吵，让他说！(CTS)**”。然后你才开始说。

#### **3.5.3 轮询访问：令牌传递协议**
* **核心考点**: 通过传递“令牌”来决定谁有权发送。
* **形象记忆**:
    * **令牌**: 会议室里唯一的“**话筒**”。
    * **规则**: 话筒按顺序在每个人手里传递，谁拿到话筒谁才能发言，说完再传给下一个人。**公平，不会冲突，但有等待延迟**。

---

### **3.6 局域网**

#### **3.6.1 局域网的基本概念和体系结构**
* **核心考点**: 局域网特性，IEEE 802标准将数据链路层划分为`LLC`和`MAC`两个子层。

#### **3.6.2 以太网与IEEE 802.3**
* **核心考点**: MAC地址（48位），以太网V2帧格式。
* **形象记忆**:
    * **MAC地址**: 设备的**身份证号**，全球唯一，固化在网卡上。
    * **以太网V2帧格式**:
        * `[目的MAC(6B)] [源MAC(6B)] [类型(2B)] [数据(46-1500B)] [FCS(4B)]`
        * **记忆**: “**收件人-发件人-物品类型-物品-封条**”

#### **3.6.3 IEEE 802.11无线局域网**
* **核心考点**: 无线局域网的两种模式（有AP/无AP），802.11帧的三个地址字段的含义。
* **形象记忆 (三个地址字段)**:
    * **场景**: 你(A)通过宿舍的无线路由器(AP)访问校外服务器(B)。
    * A发给AP的帧: `Addr1(AP)`, `Addr2(A)`, `Addr3(B)` (直接接收者是AP，直接发送者是你，最终目的地是B)。

#### **3.6.4 VLAN基本概念与基本原理**
* **核心考点**: VLAN可以在逻辑上划分广播域。
* **形象记忆**:
    * **场景**: 一个大的开放式办公室（物理局域网/广播域）。
    * **VLAN**: 用看不见的“**玻璃墙**”把办公室隔成多个小部门（逻辑广播域）。虽然销售部和技术部的人坐在一起，但他们互相听不到对方部门的广播。

---

### **3.7 广域网**

#### **3.7.1 广域网的基本概念**
* **核心考点**: 广域网通常是点对点连接的网络，协议主要工作在网络层。

#### **3.7.2 PPP协议**
* **核心考点**: 点对点协议，用于广域网。
* **特点**:
    * 简单，**不可靠**（不提供编号和确认）。
    * 面向字节，支持多种网络层协议。
    * **不需要MAC地址**，因为是点对点。

---

### **3.8 数据链路层设备**
#### **\*网桥**
早期的两端口二层网络设备
- 主要用于连接两个局域网（LAN），并在数据链路层上实现网络的扩展和通信
#### **3.8.2 以太网交换机**
* **核心考点**: 交换机的工作原理（自学习），对冲突域和广播域的隔离。**【高频考点】**
* **形象记忆 (交换机自学习)**:
    * **角色**: 一个聪明的“**楼层管理员**”。
    * **工作原理**:
        1.  刚上班时，管理员不知道每个房间（端口）里是谁（MAC地址）。
        2.  当A房间的人(MAC_A)从1号门出去送信时，管理员就在本本上记下：“**MAC_A 在 1号门**”。
        3.  当有信要送给B时，先查本本。
            * 如果本本上有记录（B在3号门），就直接从3号门送进去 (**转发**)。
            * 如果本本上没记录，就从**除了信源（1号门）外的所有门**广播（**泛洪**）。
            * 如果信是送给A的，管理员一看A就在1号门，信也是从1号门进来的，就把信**丢弃**（**过滤**）。
* **隔离域对比**:
    * **集线器(Hub)**: 物理层设备，像一个**广播喇叭**。所有端口在**同一个冲突域**和**同一个广播域**。
    * **交换机(Switch)**: 链路层设备，像**楼层管理员**。**每个端口是一个独立的冲突域**，但所有端口仍属于**同一个广播域**。

---

第三章内容虽多，但核心就是 **可靠传输协议(SW, GBN, SR)** 和 **MAC访问控制协议(CSMA/CD, CSMA/CA)**。把这两个大块头拿下，再辅以帧格式、设备原理，这一章的分数就稳了！多画图，多做计算题！
</div>
<div style="float: right; width: 26%; padding: 1%;">

</div>
<div style="clear: both;"></div>
