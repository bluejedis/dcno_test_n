<div style="float: left; width: 64%; padding: 1%;">

## <span style="color: LightSkyBlue;">随机</span>访问<span style="color: purple;">介质</span>访问控制  

<ul>

>pro：信道划分与随机访问介质访问控制的特点（2014）  

- 在随机访问协议中
  - 不采用集中控制方式解决发送信息的次序问题
  - 所有用户都能根据自己的意愿随机地发送信息，占用信道的全部速率
  - 在总线形网络中
    - 当有两个或多个用户同时发送信息时，就会产生帧冲突（也称碰撞）
    - 导致所有冲突用户的发送均以失败告终
  - 为了解决随机访问发生的冲突
    - 每个用户需要按照一定的规则反复地重传它的帧，直到该帧无冲突地通过
    - 这些规则就是随机访问介质访问控制协议
      - 其核心思想是：胜利者通过争用获得信道，进而获得信息的发送权
  - 因此，随机访问介质访问控制协议又称**争用型协议**。

- 可见，若采用信道划分机制
  - 则结点之间的通信要么共享空间，要么共享时间，要么共享空间和时间
- 而若采用随机访问控制机制
  - 则结点之间的通信既不共享时间，又不共享空间
  - 因此，随机介质访问控制实质上是一种将广播信道转换为点到点信道的机制

### <span style="color: pink;">ALOHA</span>协议  

<ul>

*add the definition personally*
- ALOHA本身就是一个单词，源自夏威夷语，意为"你好"或"爱"
- 早期的网络通信协议，主要用于无线局域网的数据传输
- 起源于20世纪70年代的夏威夷大学，设计用于解决多个用户通过共享媒介（如无线电波）发送数据时可能发生的冲突问题

#### 1. 纯ALOHA协议  

<ul>

- 基本思想：
  - 当总线形网络中的任何站点需要发送数据时，可以不进行任何检测就发送数据
  - 若在一段时间内未收到确认，则该站点就认为传输过程中发生了冲突
  - 发送站点需要等待一段时间后再发送数据，直至发送成功

- 工作原理：
  - 每个站均可自由地发送数据帧
  - 所有帧都是定长的，帧长用发送这个帧所需的时间来表示（用T₀表示）

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/ae9a115a7e4fbb1e8ae3ec162449673ea9bdc2251aced1d68bb09e49b721c595.jpg)  
图3.19纯ALOHA协议的工作原理  

- 发送情况示例：
  - 站1发送帧1时成功（因其他站未发送数据）
  - 站2和站N-1发送的帧2和帧3发生冲突
    - 发生冲突后需等待随机时间再重传
    - 若再次冲突，需继续等待随机时间直到成功
  - 帧4发送成功
  - 帧5和帧6发生冲突

</ul>

#### 2. 时隙ALOHA协议  

<ul>

- 基本特点：
  - 同步各站点的时间
  - 将时间划分为一段段等长的时隙
  - 规定站点只能在每个时隙开始时才能发送帧
  - 发送一帧的时间必须小于或等于时隙的长度

- 优势：
  - 避免了用户发送数据的随意性
  - 降低了产生冲突的可能性
  - 提高了信道的利用率

- 工作原理：
  - 每个帧到达后需在缓存中等待小于时隙T₀的时间才能发送
  - 一个时隙内有两个以上帧到达时，下一时隙将产生冲突
  - 冲突后重传策略与纯ALOHA协议相似

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/eab8d419e4bb0d1523f4496ef9b820a30d21ab1ae79b7a85d33598e667eac4dc.jpg)  
图3.20时隙ALOHA协议的工作原理

</ul>

</ul>

### <span style="color: green;">C</span>S<span style="color: SlateBlue;">M</span><span style="color: LightSkyBlue;">A</span>协议  <span style="color: gray; font-size: 14px;">载波监听 多路访问 (Carrier Sense Multiple Access)</span>

<ul>

- ALOHA网络发生冲突的概率很大
- 若每个站点在发送前都先监听公用信道，发现信道空闲后再发送，则会大大降低冲突的可能性，从而提高信道的利用率，载波监听 多路访问（Carrier Sense Multiple Access，CSMA）
- CSMA ALOHA一种改进协议，它与ALOHA协议的主要区别是多了一个载波监听装置

#### 1. 分类

<ul>

根据监听方式和监听到信道忙后的处理方式的不同，CSMA协议分为三种。  

##### (1) 1-坚持CSMA  

<ul>

- 基本思想：
  - 当站点要发送数据时，首先监听信道
  - 若信道空闲，则立即发送数据
  - 若信道忙，则继续监听直至信道空闲
- 名称含义：
  - "坚持"的含义是监听到信道忙时，继续坚持监听信道
  - "1"的含义是监听到信道空闲时，立即发送帧的概率为1

</ul>

##### (2) 非坚持CSMA  

<ul>

- 基本思想：
  - 当站点要发送数据时，首先监听信道
  - 若信道空闲，则立即发送数据
  - 若信道忙，则放弃监听，等待一个随机的时间后，再重新监听
- 特点：
  - 降低了多个站点等待信道空闲后同时发送数据导致冲突的概率
  - 增加了数据在网络中的平均时延

</ul>

#####  (3) p-坚持CSMA  

<ul>

- 适用范围：
  - 只适用于时分信道
- 基本思想：
  - 当站点要发送数据时，首先监听信道
  - 若信道忙，则持续监听（即等到下一个时隙再监听），直至信道空闲
  - 若信道空闲，则以概率p发送数据，以概率1-p推迟到下一个时隙再继续监听
  - 直到数据发送成功
- 特点：
  - 以概率p发送数据的目的是降低1-坚持CSMA中多个站点检测到信道空闲时同时发送帧的冲突概率
  - 采用坚持"监听"的目的是克服非坚持CSMA中因随机等待造成的延迟时间较长的缺点
  - 是非坚持CSMA协议和1-坚持CSMA协议的折中

三种不同类型的CSMA协议比较如表3.1所示。  

表3.1三种不同类型的CSMA协议比较
![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/ab84e37ae6367358ae2338fa8eca6764402a28f7d79e8aa56a3fff0a09f8d685.jpg)

---

</ul>

</ul>

</ul>

---
### CSMA/ <span style="color: Gold;">C</span><span style="color: green;">D</span> <span style="color: gray; font-size: 14px;">Conflict detection</span>协议  

<ul>

>pro：CSMA/CD协议的特点（2015）  

#### 基本概念与适用范围

<ul>

- 载波监听多路访问/冲突检测（CSMA/CD）协议是CSMA协议的改进方案
  - 适用于总线形网络或半双工网络环境
  - 对于全双工网络不需要CSMA/CD协议
    - 因为全双工采用两条信道，分别用来发送和接收
    - 在任何时候，发收双方都可以发送或接收数据，不可能产生冲突

</ul>

#### 工作原理

<ul>

- 载波监听
  - 每个站点在发送前和发送过程中都必须不停地检测信道
  - 发送前检测是为了获得发送权
  - 发送过程中检测是为了及时发现发送的数据是否发生冲突
- 冲突检测（CollisionDetection）
  - 边发送边监听
  - 若监听到冲突，则立即停止数据发送
  - 等待一段随机时间后，重新开始尝试发送数据
- 工作流程可简单概括为"先听后发，边听边发，冲突停发，随机重发"

>pro：信道发生冲突的最短、最长时间的分析（2010）  

</ul>

#### 信道冲突分析

<ul>

##### 传播时延影响

<ul>

- 电磁波在总线上的传播速率有限
- 当某时刻发送站检测到信道空闲时，信道不一定空闲

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/ae240d111343b3cca19a39fb51a2804acf5f10feb02fe6219bbbe3043615b345.jpg)  
图3.21传播时延对载波监听的影响  

</ul>

##### 争用期概念

<ul>

- 端到端传播时延的2倍称为争用期（又称冲突窗口）
- 每个站在自己发送数据后的一小段时间内存在发生冲突的可能性
- 只有经过争用期这段时间还未检测到冲突时，才能确定这次发送不会发生冲突

>pro：CSMA/CD最短帧长的理解和相关计算（2009、2016、2019、2022）  

</ul>

</ul>

#### 最短帧长规定

<ul>

##### 计算方法

<ul>

- 最短帧长 = 总线传播时延 × 数据传输速率 × 2

</ul>

##### 具体应用

<ul>

- 以太网规定
  - 51.2μs为争用期的长度
  - 10Mb/s的以太网在争用期内可发送512bit（64B）
  - 最短帧长为64B
- 填充规则
  - 若只发送小于64B的帧，需要在MAC子层中于数据字段后面加填充字段
  - 保证以太网的MAC帧长度不小于64B

>pro：二进制指数退避算法的应用（2023）  

</ul>

</ul>

#### 冲突处理机制

<ul>

##### 二进制指数退避算法

<ul>

- 基本退避时间确定
  - 一般取2倍的总线端到端的传播时延2τ
- 重传时间计算
  - 从离散整数集合\([0,1,⋯,(2^k-1)]\)中随机取数r
  - 重传推迟时间为r倍的争用期
  - k = min[重传次数，10]
- 重传限制
  - 重传达16次仍不成功时认为该帧无法正确发出
  - 抛弃该帧并向高层报告出错

</ul>

</ul>

#### CSMA/CD算法流程

<ul>

1. 准备发送
   - 适配器从网络层获得分组
   - 封装成帧，放入适配器缓存
2. 检测信道
   - 信道空闲则开始发送
   - 信道忙则持续检测直至空闲
3. 发送过程中持续检测
   - 发送成功：争用期内未检测到冲突
   - 发送失败：争用期内检测到冲突，执行指数退避算法

</ul>

</ul>

---
### CSMA/ <span style="color: Gold;">C</span><span style="color: DarkRed;">A</span> <span style="color: gray; font-size: 14px;">Collision Avoidance</span>协议  

<ul>

#### 协议背景

<ul>

##### 无法使用CSMA/CD的原因

<ul>

1. 硬件成本问题
   - 接收信号强度远小于发送信号强度
   - 无线介质信号强度动态变化范围大
2. 隐蔽站问题
   - 并非所有站点都能够听见对方

>pro：需要使用确认方案的MAC协议（2011）  

</ul>

</ul>

#### 确认机制

<ul>

- 使用链路层确认/重传（ARQ）方案
- 采用停止-等待协议进行可靠传输

</ul>

#### 帧间间隔机制

<ul>

>pro： CSMA/CA协议的IFS的特点（2020)  

##### IFS类型

<ul>

1. SIFS（短IFS）
   - 最短的IFS
   - 用于分隔属于一次对话的各帧
2. PIFS（点协调IFS）
   - 中等长度的IFS
   - 在PCF操作中使用
3. DIFS（分布式协调IFS）
   - 最长的IFS
   - 用于异步帧竞争访问的时延

</ul>

</ul>

#### 虚拟载波监听

<ul>

- 源站通知占用信道持续时间
- 其他站在此期间停止发送
- 减少冲突机会

</ul>

#### CSMA/CA算法流程

<ul>

1. 初始发送
   - 检测到信道空闲
   - 等待DIFS后发送整个数据帧
2. 退避机制
   - 执行CSMA/CA退避算法
   - 选取随机退避值
3. 发送与确认
   - 退避计时器为0时发送整个帧
   - 等待确认
4. 后续处理
   - 收到确认：准备发送下一帧
   - 未收到确认：重传该帧

</ul>

####  处理隐蔽站问题： <span style="color: Gold;">R</span>T<span style="color: LightSkyBlue;">S</span>和<span style="color: green;">C</span>TS  <span style="color: gray; font-size: 14px;"> (Request To Send) & (Clear To Send)</span>

<ul>

##### 隐蔽站问题产生原因

<ul>

- 站A和站B都在AP的覆盖范围内，但相距较远
- 彼此都听不见对方
- 当检测到信道空闲时，都向AP发送数据，导致冲突发生

>pro：CSMA/CA协议进行信道预约的方法（2018）  

</ul>

##### 解决方案：信道预约机制

<ul>

###### 预约过程

<ul>

- 源站发送前的准备：
  - 监听信道确认空闲
  - 等待DIFS时间
  - 广播RTS控制帧(包含源地址、目的地址和通信持续时间)

- AP的响应处理：
  - 正确接收RTS且信道空闲
  - 等待SIFS后发送CTS控制帧
  - CTS帧包含通信持续时间

- 数据传输流程：
  - 源站收到CTS后等待SIFS
  - 发送数据帧
  - AP正确接收后等待SIFS
  - 向源站发送ACK确认帧

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/c3ab7d2f814295e28c23f9b8d7d6e27883b83fde9116c67df227adcbfb64b071.jpg)  
图3.22A站和B站同时向AP发送信号，发生冲突  

![](https://cdn-mineru.openxlab.org.cn/model-mineru/prod/2674c2b5b366aab47d9a818ebdb238e29926b42fa0b01c12631f7f41d08ac0bc.jpg)  
图3.23使用RTS和CTS帧的冲突避免  

</ul>

###### 时间计算

<ul>

- RTS帧中的持续时间：
  - 从RTS帧发送完到ACK帧发送完
  - 计算公式：SIFS+CTS+SIFS+数据帧+SIFS+ACK

- CTS帧中的持续时间：
  - 从CTS帧发送完到ACK帧发送完
  - 计算公式：SIFS+数据帧+SIFS+ACK

</ul>

</ul>

##### 预约机制特点

<ul>

- 效率影响：
  - RTS和CTS帧会略微降低通信效率
  - 但这两种帧都很短，开销相对较小
  - 比起冲突重发更节省时间

- 使用规则：
  - 非强制性规定
  - 各站可自行决定是否使用
  - 数据帧长超过特定值时较为划算

</ul>

##### CSMA/<span style="color: Gold;">C</span><span style="color: green;">D</span>与CSMA/<span style="color: Gold;">C</span><span style="color: DarkRed;">A</span> <span style="color: gray; font-size: 14px;">的区别</span>

<ul>

- 冲突处理方式：
  - CSMA/CD：可检测但无法避免冲突
  - CSMA/CA：无法检测但尽量避免冲突

- 应用环境：
  - CSMA/CD：用于总线形以太网
  - CSMA/CA：用于无线局域网802.11系列

- 检测机制：
  - CSMA/CD：通过电缆电压变化检测
  - CSMA/CA：采用能量检测、载波检测和混合检测

</ul>

##### 总结

<ul>

- CSMA/CA：
  - 发送前先广播告知
  - 要求其他站点在特定时间内不发送
  - 预防性避免冲突

- CSMA/CD：
  - 发送前监听
  - 边发送边监听
  - 发现冲突立即停止

</ul>

</ul>

</ul>

</ul>

</div>
<div style="float: right; width: 26%; padding: 1%;">

</div>
<div style="clear: both;"></div>
